<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_script_include">
    <sys_script_include action="INSERT_OR_UPDATE">
        <access>public</access>
        <active>true</active>
        <api_name>x_apig_recurring_t.ScheduledJobTools</api_name>
        <caller_access/>
        <client_callable>false</client_callable>
        <description/>
        <name>ScheduledJobTools</name>
        <script><![CDATA[var ScheduledJobTools = Class.create();
ScheduledJobTools.prototype = {
    /**SNDOC
	   @name initialize
       @description Sets default values
		_name = '';
		_active = 'true';
		_runType = 'periodically';
		_conditional = 'false';
		_runStart = (new GlideDateTime()).getValue();
		_runPeriod = new GlideDuration();
		_runTime = (new GlideTime()).getValue();
		_template = '';
	   @example 
	   var scheduledJobTools = new x_apig_recurring_t.ScheduledJobTools();
	   scheduledJobTools.initialize();
     */
    initialize: function() {
        this._name = '';
        this._active = 'true';
        this._runType = 'periodically';
        this._conditional = 'false';
        this._runStart = new GlideDateTime();
        this._runPeriod = (new GlideDuration()).getValue();
        this._runTime = new GlideTime();
		this._template = '';
    },
    /**SNDOC
	   @name setName
       @description Sets the name of the template
       @param {string} [val] - Name to set on the template
	   @example 
	   var scheduledJobTools = new x_apig_recurring_t.TemplateTools();
	   scheduledJobTools.setName('Request Job');
     */
    setName: function(val) {
        this._name = val;
    },
    /**SNDOC
	   @name setActive
       @description Sets the name of the template
       @param {string} [val] - Active value to set on the template (true/false string)
	   @example 
	   var scheduledJobTools = new x_apig_recurring_t.TemplateTools();
	   scheduledJobTools.setActive('true');
     */
    setActive: function(val) {
        this._active = val.toLowerCase();
    },
    /**SNDOC
	   @name setRunStart
       @description Sets when to start running the scheduled job
       @param {GlideDateTime} [val] - Date/Time to start running the job
	   @example 
       var start = new GlideDateTime();

	   var scheduledJobTools = new x_apig_recurring_t.ScheduledJobTools();
	   scheduledJobTools.initialize();
	   scheduledJobTools.setRunStart(start.getValue());
     */
    setRunStart: function(val) {
        this._runStart = val.getValue();
    },
    /**SNDOC
	   @name setRunPeriod
       @description Sets how often to run the scheduled job
       @param {String} [val] - Amount of days between runs
	   @example 
	   var duration = new GlideDuration();
       var numberOfDays = '3';
	   
	   var scheduledJobTools = new x_apig_recurring_t.ScheduledJobTools();
	   scheduledJobTools.initialize();
	   scheduledJobTools.setRunPeriod(numberOfDays);
     */
    setRunPeriod: function(val) {
		var duration = new GlideDuration(val + ' 00:00:00');
        this._runPeriod = duration.getValue();
    },
    /**SNDOC
	   @name setRunTime
       @description Sets what time of day the scheduled job will run
       @param {GlideTime} [val] - Time of day to run the job
	   @example 
	   var startTime = new GlideTime();

	   var scheduledJobTools = new x_apig_recurring_t.ScheduledJobTools();
	   scheduledJobTools.initialize();
	   scheduledJobTools.setRunTime(startTime.getValue());
     */
    setRunTime: function(val) {
        this._runTime = val.getValue();
    },
    /**SNDOC
	   @name setTemplate
       @description Sets what template will be generated by the job
       @param {string} [val] - Sys_Id of the template to run from sys_template table
	   @example 
	   var scheduledJobTools = new x_apig_recurring_t.ScheduledJobTools();
	   scheduledJobTools.initialize();
	   scheduledJobTools.setRunTime('sys_id_here');
     */
    setTemplate: function(val) {
        this._template = val;
    },
    /**SNDOC
	   @name insert
       @description Inserts the template into the sys_template table based on values set
       @returns {string} Sys ID of the record inserted into the table
	   @example 
       var start = new GlideDateTime();
	   var duration = new GlideDuration();
	   var startTime = new GlideTime();

	   var scheduledJobTools = new x_apig_recurring_t.ScheduledJobTools();
	   scheduledJobTools.initialize();
	   scheduledJobTools.setName('name');
	   scheduledJobTools.setActive('true');
	   scheduledJobTools.setRunStart(start.getValue());
	   scheduledJobTools.setRunPeriod(duration.getValue());
	   scheduledJobTools.setRunTime(startTime.getValue());
	   scheduledJobTools.insert();
     */
    insert: function() {
        var jobGr = new GlideRecord('sysauto_template');
        jobGr.initialize();
        jobGr.setValue('name', this._name);
        jobGr.setValue('active', this._active);
        jobGr.setValue('run_type', this._runType);
        jobGr.setValue('conditional', this._conditional);
        jobGr.setValue('run_start', this._runStart);
        jobGr.setValue('run_period', this._runPeriod);
		jobGr.setValue('run_time', this._runTime);
		jobGr.setValue('template', this._template);
        jobGr.insert();
        return jobGr.getUniqueValue();
    },
    type: 'ScheduledJobTools'
};]]></script>
        <sys_class_name>sys_script_include</sys_class_name>
        <sys_created_by>Terry.Lillo</sys_created_by>
        <sys_created_on>2021-11-11 15:40:07</sys_created_on>
        <sys_id>c9c130091bb7381062e50ed2cd4bcb31</sys_id>
        <sys_mod_count>24</sys_mod_count>
        <sys_name>ScheduledJobTools</sys_name>
        <sys_package display_value="Recurring Tasks" source="x_apig_recurring_t">1f9b20cd1b77381062e50ed2cd4bcb6e</sys_package>
        <sys_policy>read</sys_policy>
        <sys_scope display_value="Recurring Tasks">1f9b20cd1b77381062e50ed2cd4bcb6e</sys_scope>
        <sys_update_name>sys_script_include_c9c130091bb7381062e50ed2cd4bcb31</sys_update_name>
        <sys_updated_by>Terry.Lillo</sys_updated_by>
        <sys_updated_on>2021-11-22 21:56:29</sys_updated_on>
    </sys_script_include>
</record_update>
